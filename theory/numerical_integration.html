

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Numerical Integration &mdash; cubie 0.0.4 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=9edc463e" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=1b720227" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=8c5712d9"></script>
      <script src="../_static/doctools.js?v=fd6eb6e6"></script>
      <script src="../_static/sphinx_highlight.js?v=6ffebe34"></script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Nonlinear Solvers" href="solvers.html" />
    <link rel="prev" title="Theory" href="index.html" /> 
<meta name="google-site-verification" content="Fpgkmgu5X-0RRG9UUYo4erbY0wd7VmLIQU4UZv_YaXc" />
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            cubie
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started with Cubie</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/index.html">User Manual</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/systems.html">Creating a “System” of Differential Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/solving.html">Solving ODEs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/batching.html">Batching and Parameter Sweeps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/results.html">Working with Results</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/drivers.html">Drivers (Time-dependent functions)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/timing.html">Timing Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/choosing_algorithms.html">Choosing an Algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/optional_arguments.html">Optional Arguments Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/userfunctions.html">User functions and derivatives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/cellml.html">CellML Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/memory.html">GPU Memory Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/caching.html">Caching and Recompilation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/speed.html">Making it Faster (basic)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/troubleshooting.html">Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Theory</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Numerical Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="solvers.html">Nonlinear Solvers</a></li>
<li class="toctree-l2"><a class="reference internal" href="jacobians.html">Jacobians and Symbolic Differentiation</a></li>
<li class="toctree-l2"><a class="reference internal" href="cuda.html">CUDA and GPU Computing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide/index.html">Developer Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../developer_guide/architecture.html">Architecture Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer_guide/adding_algorithms.html">Adding Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer_guide/codegen.html">Code Generation Pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer_guide/buffer_registry.html">Buffer Registry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer_guide/adding_metrics.html">Adding Summary Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer_guide/testing.html">Testing Guide</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../API_reference/index.html">Reference Manual</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../API_reference/batchsolving/index.html">Batch solving</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../API_reference/batchsolving/solver.html">Solver</a></li>
<li class="toctree-l3"><a class="reference internal" href="../API_reference/batchsolving/solve_ivp.html">solve_ivp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../API_reference/batchsolving/solve_result.html">SolveResult</a></li>
<li class="toctree-l3"><a class="reference internal" href="../API_reference/batchsolving/solve_spec.html">SolveSpec</a></li>
<li class="toctree-l3"><a class="reference internal" href="../API_reference/batchsolving/batch_solver_config.html">BatchSolverConfig</a></li>
<li class="toctree-l3"><a class="reference internal" href="../API_reference/batchsolving/batch_solver_kernel.html">BatchSolverKernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../API_reference/batchsolving/system_interface.html">SystemInterface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../API_reference/batchsolving/arrays.html">Arrays</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/batchsolving/array_container.html">ArrayContainer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/batchsolving/base_array_manager.html">BaseArrayManager</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/batchsolving/managed_array.html">ManagedArray</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/batchsolving/input_array_container.html">InputArrayContainer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/batchsolving/input_arrays.html">InputArrays</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/batchsolving/output_array_container.html">OutputArrayContainer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/batchsolving/active_outputs.html">ActiveOutputs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/batchsolving/output_arrays.html">OutputArrays</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../API_reference/odesystems/index.html">ODE systems</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../API_reference/odesystems/create_ode_system.html">create_ODE_system</a></li>
<li class="toctree-l3"><a class="reference internal" href="../API_reference/odesystems/symbolic_ode.html">SymbolicODE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../API_reference/odesystems/base_ode.html">BaseODE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../API_reference/odesystems/ode_data.html">ODEData</a></li>
<li class="toctree-l3"><a class="reference internal" href="../API_reference/odesystems/system_values.html">SystemValues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../API_reference/odesystems/system_sizes.html">SystemSizes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../API_reference/odesystems/ode_cache.html">ODECache</a></li>
<li class="toctree-l3"><a class="reference internal" href="../API_reference/odesystems/symbolic.html">Symbolic</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../API_reference/integrators/index.html">Integrators</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../API_reference/integrators/single_integrator_run.html">SingleIntegratorRun</a></li>
<li class="toctree-l3"><a class="reference internal" href="../API_reference/integrators/integrator_return_codes.html">IntegratorReturnCodes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../API_reference/integrators/algorithms.html">Algorithms</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/integrators/algorithms/base_step_config.html">BaseStepConfig</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/integrators/algorithms/base_algorithm_step.html">BaseAlgorithmStep</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/integrators/algorithms/step_cache.html">StepCache</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/integrators/algorithms/explicit_step_config.html">ExplicitStepConfig</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/integrators/algorithms/explicit_euler_step.html">ExplicitEulerStep</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/integrators/algorithms/implicit_step_config.html">ImplicitStepConfig</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/integrators/algorithms/backwards_euler_step.html">BackwardsEulerStep</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/integrators/algorithms/backwards_euler_pc_step.html">BackwardsEulerPCStep</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/integrators/algorithms/crank_nicolson_step.html">CrankNicolsonStep</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/integrators/algorithms/generic_erk_step.html">ERKStep</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/integrators/algorithms/generic_erk_tableaus.html">ERK tableau registry</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/integrators/algorithms/generic_dirk_step.html">DIRKStep</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/integrators/algorithms/generic_dirk_tableaus.html">DIRK tableau registry</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/integrators/algorithms/generic_firk_step.html">FIRKStep</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/integrators/algorithms/generic_firk_tableaus.html">FIRK tableau registry</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/integrators/algorithms/generic_rosenbrock_step.html">GenericRosenbrockWStep</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/integrators/algorithms/generic_rosenbrock_tableaus.html">Rosenbrock tableau registry</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/integrators/algorithms/get_algorithm_step.html">get_algorithm_step</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../API_reference/integrators/loops.html">Loops</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/integrators/loops/ivp_loop.html">IVPLoop</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/integrators/loops/ode_loop_config.html">ODELoopConfig</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../API_reference/integrators/matrix_free_solvers.html">Matrix-free solvers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/integrators/matrix_free_solvers/linear_solver_factory.html">LinearSolver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/integrators/matrix_free_solvers/newton_krylov_solver_factory.html">NewtonKrylov</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/integrators/matrix_free_solvers/solver_ret_codes.html">SolverRetCodes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../API_reference/integrators/step_control.html">Step control</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/integrators/step_control/get_controller.html">get_controller</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/integrators/step_control/base_step_controller.html">BaseStepController</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/integrators/step_control/base_adaptive_step_controller.html">BaseAdaptiveStepController</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/integrators/step_control/fixed_step_controller.html">FixedStepController</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/integrators/step_control/adaptive_i_controller.html">AdaptiveIController</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/integrators/step_control/adaptive_pi_controller.html">AdaptivePIController</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/integrators/step_control/adaptive_pid_controller.html">AdaptivePIDController</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/integrators/step_control/gustafsson_controller.html">GustafssonController</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/integrators/step_control/base_step_controller_config.html">BaseStepControllerConfig</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/integrators/step_control/adaptive_step_control_config.html">AdaptiveStepControlConfig</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/integrators/step_control/fixed_step_control_config.html">FixedStepControlConfig</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/integrators/step_control/pi_step_control_config.html">PIStepControlConfig</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/integrators/step_control/pid_step_control_config.html">PIDStepControlConfig</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/integrators/step_control/gustafsson_step_control_config.html">GustafssonStepControlConfig</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../API_reference/outputhandling/index.html">Output handling</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../API_reference/outputhandling/output_functions.html">OutputFunctions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../API_reference/outputhandling/output_config.html">OutputConfig</a></li>
<li class="toctree-l3"><a class="reference internal" href="../API_reference/outputhandling/output_compile_flags.html">OutputCompileFlags</a></li>
<li class="toctree-l3"><a class="reference internal" href="../API_reference/outputhandling/output_array_heights.html">OutputArrayHeights</a></li>
<li class="toctree-l3"><a class="reference internal" href="../API_reference/outputhandling/single_run_output_sizes.html">SingleRunOutputSizes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../API_reference/outputhandling/batch_input_sizes.html">BatchInputSizes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../API_reference/outputhandling/batch_output_sizes.html">BatchOutputSizes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../API_reference/outputhandling/output_function_cache.html">OutputFunctionCache</a></li>
<li class="toctree-l3"><a class="reference internal" href="../API_reference/outputhandling/summary_metrics.html">summary_metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../API_reference/outputhandling/register_metric.html">register_metric</a></li>
<li class="toctree-l3"><a class="reference internal" href="../API_reference/outputhandling/summarymetrics.html">Summary metrics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/outputhandling/summary_metrics.html">summary_metrics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/outputhandling/register_metric.html">register_metric</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/outputhandling/summarymetrics/metrics/summary_metric.html">SummaryMetric</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/outputhandling/summarymetrics/metrics/summary_metrics.html">SummaryMetrics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/outputhandling/summarymetrics/metrics/metric_func_cache.html">MetricFuncCache</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/outputhandling/summarymetrics/metrics/mean.html">Mean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/outputhandling/summarymetrics/metrics/max.html">Max</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/outputhandling/summarymetrics/metrics/rms.html">RMS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/outputhandling/summarymetrics/metrics/peaks.html">Peaks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/outputhandling/summarymetrics/metrics/std.html">Std</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/outputhandling/summarymetrics/metrics/min.html">Min</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/outputhandling/summarymetrics/metrics/max_magnitude.html">MaxMagnitude</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/outputhandling/summarymetrics/metrics/extrema.html">Extrema</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/outputhandling/summarymetrics/metrics/negative_peaks.html">NegativePeaks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/outputhandling/summarymetrics/metrics/mean_std_rms.html">MeanStdRms</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/outputhandling/summarymetrics/metrics/dxdt_max.html">DxdtMax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/outputhandling/summarymetrics/metrics/dxdt_min.html">DxdtMin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/outputhandling/summarymetrics/metrics/dxdt_extrema.html">DxdtExtrema</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/outputhandling/summarymetrics/metrics/d2xdt2_max.html">D2xdt2Max</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/outputhandling/summarymetrics/metrics/d2xdt2_min.html">D2xdt2Min</a></li>
<li class="toctree-l4"><a class="reference internal" href="../API_reference/outputhandling/summarymetrics/metrics/d2xdt2_extrema.html">D2xdt2Extrema</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../API_reference/memory.html">Memory</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../API_reference/memory/default_memmgr.html">default_memmgr</a></li>
<li class="toctree-l3"><a class="reference internal" href="../API_reference/memory/memory_manager.html">MemoryManager</a></li>
<li class="toctree-l3"><a class="reference internal" href="../API_reference/memory/array_request.html">ArrayRequest</a></li>
<li class="toctree-l3"><a class="reference internal" href="../API_reference/memory/array_response.html">ArrayResponse</a></li>
<li class="toctree-l3"><a class="reference internal" href="../API_reference/memory/stream_groups.html">StreamGroups</a></li>
<li class="toctree-l3"><a class="reference internal" href="../API_reference/memory/current_cupy_stream.html">current_cupy_stream</a></li>
<li class="toctree-l3"><a class="reference internal" href="../API_reference/memory/cupy_async_numba_manager.html">CuPyAsyncNumbaManager</a></li>
<li class="toctree-l3"><a class="reference internal" href="../API_reference/memory/cupy_sync_numba_manager.html">CuPySyncNumbaManager</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../API_reference/gui/index.html">GUI Editors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../API_reference/gui/constants_editor.html">ConstantsEditor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../API_reference/gui/states_editor.html">StatesEditor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../API_reference/gui/pre_parse_editor.html">PreParseEditor</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">cubie</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Theory</a></li>
      <li class="breadcrumb-item active">Numerical Integration</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/theory/numerical_integration.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="numerical-integration">
<h1>Numerical Integration<a class="headerlink" href="#numerical-integration" title="Link to this heading"></a></h1>
<p>This page covers the mathematical foundations behind the ODE integration
algorithms available in CuBIE. For a practical guide to choosing an
algorithm, see <a class="reference internal" href="../user_guide/choosing_algorithms.html"><span class="doc">Choosing an Algorithm</span></a>.</p>
<section id="euler-s-method">
<h2>Euler’s Method<a class="headerlink" href="#euler-s-method" title="Link to this heading"></a></h2>
<p>The simplest approach to solving an ODE numerically is Euler’s method.
Given a state <span class="math notranslate nohighlight">\(x_n\)</span> at time <span class="math notranslate nohighlight">\(t_n\)</span>, we compute the next state by
stepping in the direction of the derivative:</p>
<div class="math notranslate nohighlight">
\[x_{n+1} = x_n + h\, f(t_n, x_n)\]</div>
<p>where <span class="math notranslate nohighlight">\(h\)</span> is the step size and <span class="math notranslate nohighlight">\(f\)</span> is the right-hand-side
function.  This is a first-order method: halving <span class="math notranslate nohighlight">\(h\)</span> halves the local
error.  It is simple and cheap, but its low accuracy makes it impractical
for most real problems unless a very small step size is acceptable.</p>
</section>
<section id="runge-kutta-methods">
<h2>Runge–Kutta Methods<a class="headerlink" href="#runge-kutta-methods" title="Link to this heading"></a></h2>
<p>Runge–Kutta (RK) methods improve on Euler by evaluating <span class="math notranslate nohighlight">\(f\)</span> at
several intermediate points within each step and combining the results.
A general <span class="math notranslate nohighlight">\(s\)</span>-stage RK method computes <em>stages</em>:</p>
<div class="math notranslate nohighlight">
\[k_i = f\!\Bigl(t_n + c_i h,\; x_n + h \sum_{j=1}^{s} a_{ij}\, k_j\Bigr),
\qquad i = 1, \dots, s\]</div>
<p>and then updates the state:</p>
<div class="math notranslate nohighlight">
\[x_{n+1} = x_n + h \sum_{i=1}^{s} b_i\, k_i.\]</div>
<p>The coefficients <span class="math notranslate nohighlight">\(a_{ij}\)</span>, <span class="math notranslate nohighlight">\(b_i\)</span>, and <span class="math notranslate nohighlight">\(c_i\)</span> are collected
in a <em>Butcher tableau</em>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{c|c}
\mathbf{c} &amp; A \\
\hline
           &amp; \mathbf{b}^T
\end{array}\end{split}\]</div>
<p>The <em>order</em> of a method describes how quickly its error shrinks as
<span class="math notranslate nohighlight">\(h \to 0\)</span>.  An order-<span class="math notranslate nohighlight">\(p\)</span> method has a local truncation error
proportional to <span class="math notranslate nohighlight">\(h^{p+1}\)</span>.</p>
<section id="embedded-error-pairs">
<h3>Embedded Error Pairs<a class="headerlink" href="#embedded-error-pairs" title="Link to this heading"></a></h3>
<p>Many practical RK methods come in <em>embedded pairs</em>: two methods of
different orders that share the same stages.  The difference between their
results provides a free error estimate without extra function evaluations.
For example, the Dormand–Prince 5(4) pair uses the same six stages to
produce both a fifth-order and a fourth-order solution; the gap between
them estimates the local error and drives adaptive step-size control.</p>
</section>
</section>
<section id="explicit-vs-implicit-methods">
<h2>Explicit vs Implicit Methods<a class="headerlink" href="#explicit-vs-implicit-methods" title="Link to this heading"></a></h2>
<p>In an <em>explicit</em> method the matrix <span class="math notranslate nohighlight">\(A\)</span> is strictly lower-triangular:
each stage depends only on previously computed stages, so they can be
evaluated sequentially in a single forward pass.</p>
<p>In an <em>implicit</em> method <span class="math notranslate nohighlight">\(A\)</span> has entries on or above the diagonal,
meaning stages depend on each other.  This produces a coupled system of
nonlinear equations that must be solved at every step (see
<a class="reference internal" href="solvers.html"><span class="doc">Nonlinear Solvers</span></a>).  The extra cost buys better stability, which matters for
<em>stiff</em> problems.</p>
<section id="stiffness">
<h3>Stiffness<a class="headerlink" href="#stiffness" title="Link to this heading"></a></h3>
<p>A system is <em>stiff</em> when it contains dynamics on vastly different time
scales.  The Jacobian <span class="math notranslate nohighlight">\(\partial f / \partial x\)</span> then has eigenvalues
with large negative real parts, and explicit methods must take
impractically small steps to remain stable.  Implicit methods avoid this
because their stability regions extend far into the left half-plane.</p>
</section>
</section>
<section id="algorithm-families-in-cubie">
<h2>Algorithm Families in CuBIE<a class="headerlink" href="#algorithm-families-in-cubie" title="Link to this heading"></a></h2>
<dl class="simple">
<dt><strong>ERK (Explicit Runge–Kutta)</strong></dt><dd><p>Lower-triangular <span class="math notranslate nohighlight">\(A\)</span>.  Fast per step, best for non-stiff or
mildly stiff problems.  CuBIE ships Dormand–Prince 5(4), Tsitouras
5(4), Bogacki–Shampine 3(2), and others.</p>
</dd>
<dt><strong>DIRK (Diagonally Implicit Runge–Kutta)</strong></dt><dd><p><span class="math notranslate nohighlight">\(A\)</span> is lower-triangular with non-zero diagonal entries.  Each
stage requires solving a single nonlinear system of size <span class="math notranslate nohighlight">\(n\)</span> (the
number of states).  Good balance between stability and cost.</p>
</dd>
<dt><strong>FIRK (Fully Implicit Runge–Kutta)</strong></dt><dd><p><span class="math notranslate nohighlight">\(A\)</span> is a full <span class="math notranslate nohighlight">\(s \times s\)</span> matrix.  All stages are coupled,
requiring a system of size <span class="math notranslate nohighlight">\(s \times n\)</span>.  CuBIE provides
Gauss–Legendre and Radau IIA methods, which achieve the highest
possible order for their stage count.</p>
</dd>
<dt><strong>Rosenbrock-W</strong></dt><dd><p>Linearly implicit methods that replace Newton iteration with a single
linear solve per stage.  They require the Jacobian <span class="math notranslate nohighlight">\(J\)</span> and the
time derivative <span class="math notranslate nohighlight">\(\partial f / \partial t\)</span>, but avoid the iterative
convergence loop of fully implicit methods.  Well suited to moderately
stiff problems where Newton iteration cost would dominate.</p>
</dd>
</dl>
</section>
<section id="adaptive-stepping">
<h2>Adaptive Stepping<a class="headerlink" href="#adaptive-stepping" title="Link to this heading"></a></h2>
<p>Adaptive methods adjust <span class="math notranslate nohighlight">\(h\)</span> at every step to keep the estimated
local error within user-specified tolerances.  The error is measured as:</p>
<div class="math notranslate nohighlight">
\[\text{err} = \left\|
    \frac{x^{(p)} - x^{(p-1)}}
         {\text{atol} + \text{rtol} \cdot |x^{(p)}|}
\right\|\]</div>
<p>where <span class="math notranslate nohighlight">\(x^{(p)}\)</span> and <span class="math notranslate nohighlight">\(x^{(p-1)}\)</span> are the higher- and
lower-order solutions from the embedded pair.</p>
<p>A <em>controller</em> uses this error to propose the next step size.  CuBIE
supports PI, PID, and Gustafsson controllers, each offering different
trade-offs between responsiveness and smoothness of the step-size
sequence.  See <a class="reference internal" href="../user_guide/choosing_algorithms.html"><span class="doc">Choosing an Algorithm</span></a> for practical
guidance.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Theory" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="solvers.html" class="btn btn-neutral float-right" title="Nonlinear Solvers" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Chris Cameron.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>