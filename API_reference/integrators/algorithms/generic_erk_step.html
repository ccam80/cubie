

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ERKStep &mdash; cubie 0.0.4 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=9edc463e" />
      <link rel="stylesheet" type="text/css" href="../../../_static/custom.css?v=1b720227" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=8c5712d9"></script>
      <script src="../../../_static/doctools.js?v=fd6eb6e6"></script>
      <script src="../../../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="ERK tableau registry" href="generic_erk_tableaus.html" />
    <link rel="prev" title="CrankNicolsonStep" href="crank_nicolson_step.html" /> 
<meta name="google-site-verification" content="Fpgkmgu5X-0RRG9UUYo4erbY0wd7VmLIQU4UZv_YaXc" />
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            cubie
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started.html">Getting Started with Cubie</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../user_guide/index.html">User Manual</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../user_guide/systems.html">Creating a “System” of Differential Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../user_guide/solving.html">Solving ODEs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../user_guide/batching.html">Batching and Parameter Sweeps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../user_guide/results.html">Working with Results</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../user_guide/drivers.html">Drivers (Time-dependent functions)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../user_guide/timing.html">Timing Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../user_guide/choosing_algorithms.html">Choosing an Algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../user_guide/optional_arguments.html">Optional Arguments Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../user_guide/userfunctions.html">User functions and derivatives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../user_guide/cellml.html">CellML Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../user_guide/memory.html">GPU Memory Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../user_guide/caching.html">Caching and Recompilation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../user_guide/speed.html">Making it Faster (basic)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../user_guide/troubleshooting.html">Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../theory/index.html">Theory</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../theory/numerical_integration.html">Numerical Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../theory/solvers.html">Nonlinear Solvers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../theory/jacobians.html">Jacobians and Symbolic Differentiation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../theory/cuda.html">CUDA and GPU Computing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../developer_guide/index.html">Developer Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../developer_guide/architecture.html">Architecture Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../developer_guide/adding_algorithms.html">Adding Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../developer_guide/codegen.html">Code Generation Pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../developer_guide/buffer_registry.html">Buffer Registry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../developer_guide/adding_metrics.html">Adding Summary Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../developer_guide/testing.html">Testing Guide</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Reference Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../batchsolving/index.html">Batch solving</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../batchsolving/solver.html">Solver</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../batchsolving/solve_ivp.html">solve_ivp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../batchsolving/solve_result.html">SolveResult</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../batchsolving/solve_spec.html">SolveSpec</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../batchsolving/batch_solver_config.html">BatchSolverConfig</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../batchsolving/batch_solver_kernel.html">BatchSolverKernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../batchsolving/system_interface.html">SystemInterface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../batchsolving/arrays.html">Arrays</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../batchsolving/array_container.html">ArrayContainer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../batchsolving/base_array_manager.html">BaseArrayManager</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../batchsolving/managed_array.html">ManagedArray</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../batchsolving/input_array_container.html">InputArrayContainer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../batchsolving/input_arrays.html">InputArrays</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../batchsolving/output_array_container.html">OutputArrayContainer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../batchsolving/active_outputs.html">ActiveOutputs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../batchsolving/output_arrays.html">OutputArrays</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../odesystems/index.html">ODE systems</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../odesystems/create_ode_system.html">create_ODE_system</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../odesystems/symbolic_ode.html">SymbolicODE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../odesystems/base_ode.html">BaseODE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../odesystems/ode_data.html">ODEData</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../odesystems/system_values.html">SystemValues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../odesystems/system_sizes.html">SystemSizes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../odesystems/ode_cache.html">ODECache</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../odesystems/symbolic.html">Symbolic</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Integrators</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../single_integrator_run.html">SingleIntegratorRun</a></li>
<li class="toctree-l3"><a class="reference internal" href="../integrator_return_codes.html">IntegratorReturnCodes</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../algorithms.html">Algorithms</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="base_step_config.html">BaseStepConfig</a></li>
<li class="toctree-l4"><a class="reference internal" href="base_algorithm_step.html">BaseAlgorithmStep</a></li>
<li class="toctree-l4"><a class="reference internal" href="step_cache.html">StepCache</a></li>
<li class="toctree-l4"><a class="reference internal" href="explicit_step_config.html">ExplicitStepConfig</a></li>
<li class="toctree-l4"><a class="reference internal" href="explicit_euler_step.html">ExplicitEulerStep</a></li>
<li class="toctree-l4"><a class="reference internal" href="implicit_step_config.html">ImplicitStepConfig</a></li>
<li class="toctree-l4"><a class="reference internal" href="backwards_euler_step.html">BackwardsEulerStep</a></li>
<li class="toctree-l4"><a class="reference internal" href="backwards_euler_pc_step.html">BackwardsEulerPCStep</a></li>
<li class="toctree-l4"><a class="reference internal" href="crank_nicolson_step.html">CrankNicolsonStep</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">ERKStep</a></li>
<li class="toctree-l4"><a class="reference internal" href="generic_erk_tableaus.html">ERK tableau registry</a></li>
<li class="toctree-l4"><a class="reference internal" href="generic_dirk_step.html">DIRKStep</a></li>
<li class="toctree-l4"><a class="reference internal" href="generic_dirk_tableaus.html">DIRK tableau registry</a></li>
<li class="toctree-l4"><a class="reference internal" href="generic_firk_step.html">FIRKStep</a></li>
<li class="toctree-l4"><a class="reference internal" href="generic_firk_tableaus.html">FIRK tableau registry</a></li>
<li class="toctree-l4"><a class="reference internal" href="generic_rosenbrock_step.html">GenericRosenbrockWStep</a></li>
<li class="toctree-l4"><a class="reference internal" href="generic_rosenbrock_tableaus.html">Rosenbrock tableau registry</a></li>
<li class="toctree-l4"><a class="reference internal" href="get_algorithm_step.html">get_algorithm_step</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../loops.html">Loops</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../loops/ivp_loop.html">IVPLoop</a></li>
<li class="toctree-l4"><a class="reference internal" href="../loops/ode_loop_config.html">ODELoopConfig</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../matrix_free_solvers.html">Matrix-free solvers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../matrix_free_solvers/linear_solver_factory.html">LinearSolver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../matrix_free_solvers/newton_krylov_solver_factory.html">NewtonKrylov</a></li>
<li class="toctree-l4"><a class="reference internal" href="../matrix_free_solvers/solver_ret_codes.html">SolverRetCodes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../step_control.html">Step control</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../step_control/get_controller.html">get_controller</a></li>
<li class="toctree-l4"><a class="reference internal" href="../step_control/base_step_controller.html">BaseStepController</a></li>
<li class="toctree-l4"><a class="reference internal" href="../step_control/base_adaptive_step_controller.html">BaseAdaptiveStepController</a></li>
<li class="toctree-l4"><a class="reference internal" href="../step_control/fixed_step_controller.html">FixedStepController</a></li>
<li class="toctree-l4"><a class="reference internal" href="../step_control/adaptive_i_controller.html">AdaptiveIController</a></li>
<li class="toctree-l4"><a class="reference internal" href="../step_control/adaptive_pi_controller.html">AdaptivePIController</a></li>
<li class="toctree-l4"><a class="reference internal" href="../step_control/adaptive_pid_controller.html">AdaptivePIDController</a></li>
<li class="toctree-l4"><a class="reference internal" href="../step_control/gustafsson_controller.html">GustafssonController</a></li>
<li class="toctree-l4"><a class="reference internal" href="../step_control/base_step_controller_config.html">BaseStepControllerConfig</a></li>
<li class="toctree-l4"><a class="reference internal" href="../step_control/adaptive_step_control_config.html">AdaptiveStepControlConfig</a></li>
<li class="toctree-l4"><a class="reference internal" href="../step_control/fixed_step_control_config.html">FixedStepControlConfig</a></li>
<li class="toctree-l4"><a class="reference internal" href="../step_control/pi_step_control_config.html">PIStepControlConfig</a></li>
<li class="toctree-l4"><a class="reference internal" href="../step_control/pid_step_control_config.html">PIDStepControlConfig</a></li>
<li class="toctree-l4"><a class="reference internal" href="../step_control/gustafsson_step_control_config.html">GustafssonStepControlConfig</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../outputhandling/index.html">Output handling</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../outputhandling/output_functions.html">OutputFunctions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../outputhandling/output_config.html">OutputConfig</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../outputhandling/output_compile_flags.html">OutputCompileFlags</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../outputhandling/output_array_heights.html">OutputArrayHeights</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../outputhandling/single_run_output_sizes.html">SingleRunOutputSizes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../outputhandling/batch_input_sizes.html">BatchInputSizes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../outputhandling/batch_output_sizes.html">BatchOutputSizes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../outputhandling/output_function_cache.html">OutputFunctionCache</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../outputhandling/summary_metrics.html">summary_metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../outputhandling/register_metric.html">register_metric</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../outputhandling/summarymetrics.html">Summary metrics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../outputhandling/summary_metrics.html">summary_metrics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../outputhandling/register_metric.html">register_metric</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../outputhandling/summarymetrics/metrics/summary_metric.html">SummaryMetric</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../outputhandling/summarymetrics/metrics/summary_metrics.html">SummaryMetrics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../outputhandling/summarymetrics/metrics/metric_func_cache.html">MetricFuncCache</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../outputhandling/summarymetrics/metrics/mean.html">Mean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../outputhandling/summarymetrics/metrics/max.html">Max</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../outputhandling/summarymetrics/metrics/rms.html">RMS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../outputhandling/summarymetrics/metrics/peaks.html">Peaks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../outputhandling/summarymetrics/metrics/std.html">Std</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../outputhandling/summarymetrics/metrics/min.html">Min</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../outputhandling/summarymetrics/metrics/max_magnitude.html">MaxMagnitude</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../outputhandling/summarymetrics/metrics/extrema.html">Extrema</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../outputhandling/summarymetrics/metrics/negative_peaks.html">NegativePeaks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../outputhandling/summarymetrics/metrics/mean_std_rms.html">MeanStdRms</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../outputhandling/summarymetrics/metrics/dxdt_max.html">DxdtMax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../outputhandling/summarymetrics/metrics/dxdt_min.html">DxdtMin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../outputhandling/summarymetrics/metrics/dxdt_extrema.html">DxdtExtrema</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../outputhandling/summarymetrics/metrics/d2xdt2_max.html">D2xdt2Max</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../outputhandling/summarymetrics/metrics/d2xdt2_min.html">D2xdt2Min</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../outputhandling/summarymetrics/metrics/d2xdt2_extrema.html">D2xdt2Extrema</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../memory.html">Memory</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../memory/default_memmgr.html">default_memmgr</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../memory/memory_manager.html">MemoryManager</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../memory/array_request.html">ArrayRequest</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../memory/array_response.html">ArrayResponse</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../memory/stream_groups.html">StreamGroups</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../memory/current_cupy_stream.html">current_cupy_stream</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../memory/cupy_async_numba_manager.html">CuPyAsyncNumbaManager</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../memory/cupy_sync_numba_manager.html">CuPySyncNumbaManager</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../gui/index.html">GUI Editors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../gui/constants_editor.html">ConstantsEditor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../gui/states_editor.html">StatesEditor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../gui/pre_parse_editor.html">PreParseEditor</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">cubie</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Reference Manual</a></li>
          <li class="breadcrumb-item"><a href="../index.html">Integrators</a></li>
          <li class="breadcrumb-item"><a href="../algorithms.html">Algorithms</a></li>
      <li class="breadcrumb-item active">ERKStep</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/API_reference/integrators/algorithms/generic_erk_step.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="erkstep">
<h1>ERKStep<a class="headerlink" href="#erkstep" title="Link to this heading"></a></h1>
<p>The <a class="reference internal" href="#cubie.integrators.algorithms.ERKStep" title="cubie.integrators.algorithms.ERKStep"><code class="xref py py-class docutils literal notranslate"><span class="pre">ERKStep</span></code></a> factory wraps a configurable explicit Runge–Kutta
integrator. It accepts any <code class="xref py py-class docutils literal notranslate"><span class="pre">ERKTableau</span></code>
and ships with PI step-control defaults tuned for the embedded Dormand–Prince
pair. The factory performs staged right-hand-side evaluations on the GPU and
supports optional driver and observable callbacks.</p>
<dl class="py class">
<dt class="sig sig-object py" id="cubie.integrators.algorithms.ERKStep">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">cubie.integrators.algorithms.</span></span><span class="sig-name descname"><span class="pre">ERKStep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.14)"><span class="pre">type</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float16</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.14)"><span class="pre">type</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float32</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.14)"><span class="pre">type</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.4)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float16</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.4)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float32</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.4)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate_f</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.14)"><span class="pre">Callable</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate_observables</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.14)"><span class="pre">Callable</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate_driver_at_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.14)"><span class="pre">Callable</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_solver_helper_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.14)"><span class="pre">Callable</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tableau</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="generic_erk_tableaus.html#cubie.integrators.algorithms.generic_erk_tableaus.ERKTableau" title="cubie.integrators.algorithms.generic_erk_tableaus.ERKTableau"><span class="pre">ERKTableau</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">ERKTableau(a=((0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0),</span> <span class="pre">(0.2,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0),</span> <span class="pre">(0.075,</span> <span class="pre">0.225,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0),</span> <span class="pre">(0.9777777777777777,</span> <span class="pre">-3.7333333333333334,</span> <span class="pre">3.5555555555555554,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0),</span> <span class="pre">(2.9525986892242035,</span> <span class="pre">-11.595793324188385,</span> <span class="pre">9.822892851699436,</span> <span class="pre">-0.2908093278463649,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0),</span> <span class="pre">(2.8462752525252526,</span> <span class="pre">-10.757575757575758,</span> <span class="pre">8.906422717743473,</span> <span class="pre">0.2784090909090909,</span> <span class="pre">-0.2735313036020583,</span> <span class="pre">0.0,</span> <span class="pre">0.0),</span> <span class="pre">(0.09114583333333333,</span> <span class="pre">0.0,</span> <span class="pre">0.44923629829290207,</span> <span class="pre">0.6510416666666666,</span> <span class="pre">-0.322376179245283,</span> <span class="pre">0.13095238095238096,</span> <span class="pre">0.0)),</span> <span class="pre">b=(0.09114583333333333,</span> <span class="pre">0.0,</span> <span class="pre">0.44923629829290207,</span> <span class="pre">0.6510416666666666,</span> <span class="pre">-0.322376179245283,</span> <span class="pre">0.13095238095238096,</span> <span class="pre">0.0),</span> <span class="pre">c=(0.0,</span> <span class="pre">0.2,</span> <span class="pre">0.3,</span> <span class="pre">0.8,</span> <span class="pre">0.8888888888888888,</span> <span class="pre">1.0,</span> <span class="pre">1.0),</span> <span class="pre">order=5,</span> <span class="pre">b_hat=(0.08991319444444444,</span> <span class="pre">0.0,</span> <span class="pre">0.4534890685834082,</span> <span class="pre">0.6140625,</span> <span class="pre">-0.2715123820754717,</span> <span class="pre">0.08904761904761904,</span> <span class="pre">0.025))</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_drivers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/cubie/integrators/algorithms/generic_erk.html#ERKStep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cubie.integrators.algorithms.ERKStep" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ODEExplicitStep</span></code></p>
<p>Generic explicit Runge–Kutta step with configurable tableaus.</p>
<dl class="py method">
<dt class="sig sig-object py" id="cubie.integrators.algorithms.ERKStep.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.14)"><span class="pre">type</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float16</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.14)"><span class="pre">type</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float32</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.14)"><span class="pre">type</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.4)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float16</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.4)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float32</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.4)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate_f</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.14)"><span class="pre">Callable</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate_observables</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.14)"><span class="pre">Callable</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate_driver_at_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.14)"><span class="pre">Callable</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_solver_helper_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.14)"><span class="pre">Callable</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tableau</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="generic_erk_tableaus.html#cubie.integrators.algorithms.generic_erk_tableaus.ERKTableau" title="cubie.integrators.algorithms.generic_erk_tableaus.ERKTableau"><span class="pre">ERKTableau</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">ERKTableau(a=((0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0),</span> <span class="pre">(0.2,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0),</span> <span class="pre">(0.075,</span> <span class="pre">0.225,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0),</span> <span class="pre">(0.9777777777777777,</span> <span class="pre">-3.7333333333333334,</span> <span class="pre">3.5555555555555554,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0),</span> <span class="pre">(2.9525986892242035,</span> <span class="pre">-11.595793324188385,</span> <span class="pre">9.822892851699436,</span> <span class="pre">-0.2908093278463649,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0),</span> <span class="pre">(2.8462752525252526,</span> <span class="pre">-10.757575757575758,</span> <span class="pre">8.906422717743473,</span> <span class="pre">0.2784090909090909,</span> <span class="pre">-0.2735313036020583,</span> <span class="pre">0.0,</span> <span class="pre">0.0),</span> <span class="pre">(0.09114583333333333,</span> <span class="pre">0.0,</span> <span class="pre">0.44923629829290207,</span> <span class="pre">0.6510416666666666,</span> <span class="pre">-0.322376179245283,</span> <span class="pre">0.13095238095238096,</span> <span class="pre">0.0)),</span> <span class="pre">b=(0.09114583333333333,</span> <span class="pre">0.0,</span> <span class="pre">0.44923629829290207,</span> <span class="pre">0.6510416666666666,</span> <span class="pre">-0.322376179245283,</span> <span class="pre">0.13095238095238096,</span> <span class="pre">0.0),</span> <span class="pre">c=(0.0,</span> <span class="pre">0.2,</span> <span class="pre">0.3,</span> <span class="pre">0.8,</span> <span class="pre">0.8888888888888888,</span> <span class="pre">1.0,</span> <span class="pre">1.0),</span> <span class="pre">order=5,</span> <span class="pre">b_hat=(0.08991319444444444,</span> <span class="pre">0.0,</span> <span class="pre">0.4534890685834082,</span> <span class="pre">0.6140625,</span> <span class="pre">-0.2715123820754717,</span> <span class="pre">0.08904761904761904,</span> <span class="pre">0.025))</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_drivers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../../_modules/cubie/integrators/algorithms/generic_erk.html#ERKStep.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cubie.integrators.algorithms.ERKStep.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialise the Runge–Kutta step configuration.</p>
<p>This constructor creates an ERK step object and automatically selects
appropriate default step controller settings based on whether the
tableau has an embedded error estimate. Tableaus with error estimates
default to adaptive stepping (PI controller), while errorless tableaus
default to fixed stepping.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>precision</strong> – Floating-point precision for CUDA computations (np.float32 or
np.float64).</p></li>
<li><p><strong>n</strong> – Number of state variables in the ODE system.</p></li>
<li><p><strong>evaluate_f</strong> – Compiled CUDA device function computing state derivatives. Should
match signature expected by the integration kernel.</p></li>
<li><p><strong>evaluate_observables</strong> – Optional compiled CUDA device function computing observable
quantities from the state.</p></li>
<li><p><strong>evaluate_driver_at_t</strong> – Optional compiled CUDA device function computing time-varying
driver inputs.</p></li>
<li><p><strong>get_solver_helper_fn</strong> – Factory function returning solver helper for implicit stages (not
used in explicit methods but included for interface consistency).</p></li>
<li><p><strong>tableau</strong> – Explicit Runge–Kutta tableau describing the coefficients used by
the integrator. Defaults to <code class="xref py py-data docutils literal notranslate"><span class="pre">DEFAULT_ERK_TABLEAU</span></code>
(Dormand-Prince 5(4)).</p></li>
<li><p><strong>n_drivers</strong> – Number of driver variables in the system.</p></li>
<li><p><strong>**kwargs</strong> – Optional parameters passed to config classes. See ERKStepConfig
for available parameters. None values are ignored.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The step controller defaults are selected dynamically:</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">tableau.has_error_estimate</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>:
Uses <code class="xref py py-data docutils literal notranslate"><span class="pre">ERK_ADAPTIVE_DEFAULTS</span></code> (PI controller)</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">tableau.has_error_estimate</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>:
Uses <code class="xref py py-data docutils literal notranslate"><span class="pre">ERK_FIXED_DEFAULTS</span></code> (fixed-step controller)</p></li>
</ul>
<p>This automatic selection prevents incompatible configurations where
an adaptive controller is paired with an errorless tableau. Users
can still override these defaults by explicitly specifying step
controller settings when creating a <code class="xref py py-class docutils literal notranslate"><span class="pre">Solver</span></code> or calling
<code class="xref py py-func docutils literal notranslate"><span class="pre">solve_ivp()</span></code>.</p>
<p class="rubric">Examples</p>
<p>Create an ERK step with the default Dormand-Prince tableau:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">cubie.integrators.algorithms.generic_erk</span><span class="w"> </span><span class="kn">import</span> <span class="n">ERKStep</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">step</span> <span class="o">=</span> <span class="n">ERKStep</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">step</span><span class="o">.</span><span class="n">controller_defaults</span><span class="o">.</span><span class="n">step_controller</span><span class="p">[</span><span class="s2">&quot;step_controller&quot;</span><span class="p">]</span>
<span class="go">&#39;pid&#39;</span>
</pre></div>
</div>
<p>Create an ERK step with Classical RK4 (errorless):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">cubie.integrators.algorithms.generic_erk_tableaus</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">CLASSICAL_RK4_TABLEAU</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">step</span> <span class="o">=</span> <span class="n">ERKStep</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">tableau</span><span class="o">=</span><span class="n">CLASSICAL_RK4_TABLEAU</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">step</span><span class="o">.</span><span class="n">controller_defaults</span><span class="o">.</span><span class="n">step_controller</span><span class="p">[</span><span class="s2">&quot;step_controller&quot;</span><span class="p">]</span>
<span class="go">&#39;fixed&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubie.integrators.algorithms.ERKStep.build_step">
<span class="sig-name descname"><span class="pre">build_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">evaluate_f</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.14)"><span class="pre">Callable</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate_observables</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.14)"><span class="pre">Callable</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate_driver_at_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.14)"><span class="pre">Callable</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">numba_precision</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.14)"><span class="pre">type</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_drivers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="step_cache.html#cubie.integrators.algorithms.base_algorithm_step.StepCache" title="cubie.integrators.algorithms.base_algorithm_step.StepCache"><span class="pre">StepCache</span></a></span></span><a class="reference internal" href="../../../_modules/cubie/integrators/algorithms/generic_erk.html#ERKStep.build_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cubie.integrators.algorithms.ERKStep.build_step" title="Link to this definition"></a></dt>
<dd><p>Compile the explicit Runge–Kutta device step.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cubie.integrators.algorithms.ERKStep.is_adaptive">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">is_adaptive</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><a class="headerlink" href="#cubie.integrators.algorithms.ERKStep.is_adaptive" title="Link to this definition"></a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if algorithm calculates an error estimate.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cubie.integrators.algorithms.ERKStep.is_multistage">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">is_multistage</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><a class="headerlink" href="#cubie.integrators.algorithms.ERKStep.is_multistage" title="Link to this definition"></a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> when the method has multiple stages.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cubie.integrators.algorithms.ERKStep.order">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">order</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><a class="headerlink" href="#cubie.integrators.algorithms.ERKStep.order" title="Link to this definition"></a></dt>
<dd><p>Return the classical order of accuracy.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cubie.integrators.algorithms.ERKStep.register_buffers">
<span class="sig-name descname"><span class="pre">register_buffers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../../_modules/cubie/integrators/algorithms/generic_erk.html#ERKStep.register_buffers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cubie.integrators.algorithms.ERKStep.register_buffers" title="Link to this definition"></a></dt>
<dd><p>Register buffers with buffer_registry.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cubie.integrators.algorithms.ERKStep.threads_per_step">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">threads_per_step</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><a class="headerlink" href="#cubie.integrators.algorithms.ERKStep.threads_per_step" title="Link to this definition"></a></dt>
<dd><p>Return the number of CUDA threads that advance one state.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cubie.integrators.algorithms.generic_erk.ERKStepConfig">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">cubie.integrators.algorithms.generic_erk.</span></span><span class="sig-name descname"><span class="pre">ERKStepConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.14)"><span class="pre">type</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float16</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.14)"><span class="pre">type</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float32</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.14)"><span class="pre">type</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.4)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float16</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.4)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float32</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.4)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_drivers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate_f</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.14)"><span class="pre">Callable</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate_observables</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.14)"><span class="pre">Callable</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate_driver_at_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.14)"><span class="pre">Callable</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_solver_helper_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.14)"><span class="pre">Callable</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tableau</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="generic_erk_tableaus.html#cubie.integrators.algorithms.generic_erk_tableaus.ERKTableau" title="cubie.integrators.algorithms.generic_erk_tableaus.ERKTableau"><span class="pre">ERKTableau</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">ERKTableau(a=((0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0),</span> <span class="pre">(0.2,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0),</span> <span class="pre">(0.075,</span> <span class="pre">0.225,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0),</span> <span class="pre">(0.9777777777777777,</span> <span class="pre">-3.7333333333333334,</span> <span class="pre">3.5555555555555554,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0),</span> <span class="pre">(2.9525986892242035,</span> <span class="pre">-11.595793324188385,</span> <span class="pre">9.822892851699436,</span> <span class="pre">-0.2908093278463649,</span> <span class="pre">0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0),</span> <span class="pre">(2.8462752525252526,</span> <span class="pre">-10.757575757575758,</span> <span class="pre">8.906422717743473,</span> <span class="pre">0.2784090909090909,</span> <span class="pre">-0.2735313036020583,</span> <span class="pre">0.0,</span> <span class="pre">0.0),</span> <span class="pre">(0.09114583333333333,</span> <span class="pre">0.0,</span> <span class="pre">0.44923629829290207,</span> <span class="pre">0.6510416666666666,</span> <span class="pre">-0.322376179245283,</span> <span class="pre">0.13095238095238096,</span> <span class="pre">0.0)),</span> <span class="pre">b=(0.09114583333333333,</span> <span class="pre">0.0,</span> <span class="pre">0.44923629829290207,</span> <span class="pre">0.6510416666666666,</span> <span class="pre">-0.322376179245283,</span> <span class="pre">0.13095238095238096,</span> <span class="pre">0.0),</span> <span class="pre">c=(0.0,</span> <span class="pre">0.2,</span> <span class="pre">0.3,</span> <span class="pre">0.8,</span> <span class="pre">0.8888888888888888,</span> <span class="pre">1.0,</span> <span class="pre">1.0),</span> <span class="pre">order=5,</span> <span class="pre">b_hat=(0.08991319444444444,</span> <span class="pre">0.0,</span> <span class="pre">0.4534890685834082,</span> <span class="pre">0.6140625,</span> <span class="pre">-0.2715123820754717,</span> <span class="pre">0.08904761904761904,</span> <span class="pre">0.025))</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stage_rhs_location</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'local'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stage_accumulator_location</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'local'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/cubie/integrators/algorithms/generic_erk.html#ERKStepConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cubie.integrators.algorithms.generic_erk.ERKStepConfig" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="explicit_step_config.html#cubie.integrators.ExplicitStepConfig" title="cubie.integrators.algorithms.ode_explicitstep.ExplicitStepConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExplicitStepConfig</span></code></a></p>
<p>Configuration describing an explicit Runge–Kutta integrator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tableau</strong> (<a class="reference internal" href="generic_erk_tableaus.html#cubie.integrators.algorithms.generic_erk_tableaus.ERKTableau" title="cubie.integrators.algorithms.generic_erk_tableaus.ERKTableau"><em>cubie.integrators.algorithms.generic_erk_tableaus.ERKTableau</em></a>) – Butcher tableau coefficients for the ERK method.</p></li>
<li><p><strong>stage_rhs_location</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Memory location for the stage RHS buffer (<code class="docutils literal notranslate"><span class="pre">'local'</span></code> or
<code class="docutils literal notranslate"><span class="pre">'shared'</span></code>).</p></li>
<li><p><strong>stage_accumulator_location</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Memory location for the stage accumulator buffer (<code class="docutils literal notranslate"><span class="pre">'local'</span></code>
or <code class="docutils literal notranslate"><span class="pre">'shared'</span></code>).</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="cubie.integrators.algorithms.generic_erk.ERKStepConfig.first_same_as_last">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">first_same_as_last</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><a class="headerlink" href="#cubie.integrators.algorithms.generic_erk.ERKStepConfig.first_same_as_last" title="Link to this definition"></a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> when the tableau shares the first and last stage.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cubie.integrators.algorithms.generic_erk.ERKStepConfig.stage_accumulator_location">
<span class="sig-name descname"><span class="pre">stage_accumulator_location</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><a class="headerlink" href="#cubie.integrators.algorithms.generic_erk.ERKStepConfig.stage_accumulator_location" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cubie.integrators.algorithms.generic_erk.ERKStepConfig.stage_rhs_location">
<span class="sig-name descname"><span class="pre">stage_rhs_location</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><a class="headerlink" href="#cubie.integrators.algorithms.generic_erk.ERKStepConfig.stage_rhs_location" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cubie.integrators.algorithms.generic_erk.ERKStepConfig.tableau">
<span class="sig-name descname"><span class="pre">tableau</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="generic_erk_tableaus.html#cubie.integrators.algorithms.generic_erk_tableaus.ERKTableau" title="cubie.integrators.algorithms.generic_erk_tableaus.ERKTableau"><span class="pre">ERKTableau</span></a></span><a class="headerlink" href="#cubie.integrators.algorithms.generic_erk.ERKStepConfig.tableau" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="crank_nicolson_step.html" class="btn btn-neutral float-left" title="CrankNicolsonStep" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="generic_erk_tableaus.html" class="btn btn-neutral float-right" title="ERK tableau registry" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Chris Cameron.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>